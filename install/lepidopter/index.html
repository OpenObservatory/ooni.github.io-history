<!DOCTYPE html>


<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width"/>
  
  <title>OONI - </title>
    <link rel="stylesheet" href="/css/master.css"/>
    <link rel="stylesheet" href="/css/event.css"/>
    <link rel="stylesheet" href="/css/fonts.css"/>
  <link rel="stylesheet" href="/css/highlight-default.min.css">
  <link rel="icon" type="image/png" href="/images/favicon.png"/>
  <script src="/js/highlight.min.js"></script>
  <script src="/js/zepto.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/ooni-run/dist/widgets.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
	
	<script type="text/javascript">
		var _paq = _paq || [];
		 
		_paq.push(['trackPageView']);
		_paq.push(['enableLinkTracking']);
		(function() {
			var u="//analytics.ooni.io/";
			_paq.push(['setTrackerUrl', u+'piwik.php']);
			_paq.push(['setSiteId', '1']);
			var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
			g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
		})();
	</script>
	
</head>
<body>


<div class="container">
  <nav>
    <div class="col-1">
      <a href="/">
        <img src="../../images/ooni-header-mascot.png" width="25" height="25"/>
        <h1>OONI</h1>
      </a>
    </div>
    <div class="col-2">
      


<a href="/about/"
  
  >About</a>
<a href="/install/"
  
  >Install</a>
<a href="/nettest/"
  
  >Tests</a>
<a href="/data/"
  
  >Data</a>
<a href="/get-involved/"
  
  >Get Involved</a>
<a href="/post/"
  
   >Blog</a>

    </div>
  </nav>

  <main class="col-3 content">
  
      <h1 class="article-title">Lepidopter Installation: Help Guides and Resources</h1>
  

  
    <nav id="TableOfContents">
<ul>
<li><a href="#lepidopter-guide:7565a061641bd1e599d91e306fc304d1">Lepidopter guide</a>
<ul>
<li><a href="#about-lepidopter:7565a061641bd1e599d91e306fc304d1">About Lepidopter</a></li>
<li><a href="#requirements:7565a061641bd1e599d91e306fc304d1">Requirements</a></li>
</ul></li>
<li><a href="#downloading-and-verifying-the-lepidopter-raspberry-pi-image:7565a061641bd1e599d91e306fc304d1">Downloading and verifying the Lepidopter Raspberry Pi image</a>
<ul>
<li><a href="#download-the-lepidopter-image:7565a061641bd1e599d91e306fc304d1">Download the Lepidopter image</a></li>
<li><a href="#verify-lepidopter-raspberry-pi-image:7565a061641bd1e599d91e306fc304d1">Verify Lepidopter Raspberry Pi image</a>
<ul>
<li><a href="#import-the-lepidopter-signing-key:7565a061641bd1e599d91e306fc304d1">Import the Lepidopter signing key</a></li>
<li><a href="#set-the-trust-level-of-the-lepidopter-signing-key-optional:7565a061641bd1e599d91e306fc304d1">Set the trust level of the Lepidopter signing key (optional)</a></li>
<li><a href="#get-the-lepidopter-image-signature:7565a061641bd1e599d91e306fc304d1">Get the Lepidopter image signature</a></li>
<li><a href="#verify-the-lepidopter-image:7565a061641bd1e599d91e306fc304d1">Verify the Lepidopter image</a></li>
</ul></li>
</ul></li>
<li><a href="#setting-up-your-raspberry-pi-with-lepidopter:7565a061641bd1e599d91e306fc304d1">Setting up your Raspberry Pi with Lepidopter</a>
<ul>
<li><a href="#linux-users:7565a061641bd1e599d91e306fc304d1">Linux users</a>
<ul>
<li><a href="#disk-image-writer:7565a061641bd1e599d91e306fc304d1">Disk Image Writer</a></li>
<li><a href="#terminal:7565a061641bd1e599d91e306fc304d1">Terminal</a></li>
</ul></li>
<li><a href="#mac-os-x-users:7565a061641bd1e599d91e306fc304d1">Mac OS X users</a>
<ul>
<li><a href="#optimization:7565a061641bd1e599d91e306fc304d1">Optimization</a></li>
</ul></li>
<li><a href="#windows-users:7565a061641bd1e599d91e306fc304d1">Windows users</a>
<ul>
<li><a href="#using-flashnul-if-win32diskimager-isn-t-successful:7565a061641bd1e599d91e306fc304d1">Using flashnul (if Win32DiskImager isn&rsquo;t successful)</a></li>
</ul></li>
</ul></li>
<li><a href="#lepidopter-services:7565a061641bd1e599d91e306fc304d1">Lepidopter services</a>
<ul>
<li><a href="#access-ooniprobe-s-web-interface:7565a061641bd1e599d91e306fc304d1">Access ooniprobe&rsquo;s web interface</a></li>
<li><a href="#access-lepidopter-ssh-service:7565a061641bd1e599d91e306fc304d1">Access lepidopter SSH service</a></li>
<li><a href="#service-discovery-install-instructions:7565a061641bd1e599d91e306fc304d1">Service discovery install instructions</a>
<ul>
<li><a href="#linux:7565a061641bd1e599d91e306fc304d1">Linux</a></li>
<li><a href="#mac-osx-ios:7565a061641bd1e599d91e306fc304d1">Mac OSX/iOS</a></li>
<li><a href="#windows:7565a061641bd1e599d91e306fc304d1">Windows</a></li>
</ul></li>
<li><a href="#troubleshooting-service-discovery:7565a061641bd1e599d91e306fc304d1">Troubleshooting service discovery</a>
<ul>
<li><a href="#find-lepidopter-s-ip-address:7565a061641bd1e599d91e306fc304d1">Find Lepidopter&rsquo;s IP address</a></li>
</ul></li>
</ul></li>
<li><a href="#community-information-and-contributing:7565a061641bd1e599d91e306fc304d1">Community Information and Contributing</a>
<ul>
<li><a href="#report-bugs:7565a061641bd1e599d91e306fc304d1">Report bugs</a></li>
<li><a href="#participate:7565a061641bd1e599d91e306fc304d1">Participate</a></li>
<li><a href="#contribute:7565a061641bd1e599d91e306fc304d1">Contribute</a></li>
</ul></li>
<li><a href="#sources:7565a061641bd1e599d91e306fc304d1">Sources</a></li>
</ul>
</nav>
  
  

<h1 id="lepidopter-guide:7565a061641bd1e599d91e306fc304d1">Lepidopter guide</h1>

<p>This guide explains step-by-step how to run OONI tests from a Raspberry Pi.</p>

<p>The code of the image as well as the build script can be found in the <a href="https://github.com/TheTorProject/lepidopter">git
repository</a>.</p>

<p>Some compact documentation on how to install, build, copy to an SD card and run
Lepidopter in QEMU is described
<a href="https://github.com/TheTorProject/lepidopter/blob/master/README.md">here</a>.</p>

<h2 id="about-lepidopter:7565a061641bd1e599d91e306fc304d1">About Lepidopter</h2>

<p>Lepidopter is an <em>ooniprobe distribution</em> for Raspberry Pis.</p>

<p>This enables users to contribute to the collection of network measurements
consistently across time, without having to manually run ooniprobe from their
computers and regardless of their technical skills. This distribution is
configured in such a way that, when inserted into a Raspberry Pi and connected
to a network, it will by default run ooniprobe once a day and send collected
measurements directly to OONI’s measurement collector. It is also designed to
automatically get updated to the newest version of ooniprobe.</p>

<p>All measurements collected by Lepidopter are published on <a href="https://explorer.ooni.torproject.org/world/">OONI
Explorer</a>.</p>

<p>By using Lepidopter, you will be running the following OONI software tests via your Raspberry Pi:</p>

<ul>
<li><p><strong><a href="https://ooni.torproject.org/nettest/web-connectivity/">Web connectivity</a>:</strong>
Designed to examine whether URLs are blocked or not (and if so, how)</p></li>

<li><p><strong><a href="https://ooni.torproject.org/nettest/http-invalid-request-line/">HTTP invalid request line</a>:</strong> Designed to detect the presence of systems which could potentially be responsible for censorship, surveillance and traffic manipulation</p></li>

<li><p><strong><a href="https://ooni.torproject.org/nettest/http-header-field-manipulation/">HTTP header field manipulation</a>:</strong> Similar to the previous test (HTTP invalid request line)</p></li>

<li><p><strong><a href="https://ooni.torproject.org/nettest/meek-fronted-requests/">Meek Fronted Requests</a>:</strong> Designed to
examine whether the domains used by Meek (a type of Tor bridge) work in tested
networks</p></li>

<li><p><strong><a href="https://ooni.torproject.org/nettest/vanilla-tor/">Vanilla Tor</a>:</strong> Designed
to examine the reachability of the Tor network</p></li>

<li><p><strong><a href="https://ooni.torproject.org/nettest/tor-bridge-reachability/">Tor Bridges test</a>:</strong> Designed to
examine the reachability of Tor bridges in your network</p></li>

<li><p><strong><a href="https://ooni.torproject.org/nettest/whatsapp/">WhatsApp test</a>:</strong> Designed
to examine the reachability of both WhatsApp and WhatsApp&rsquo;s web interface
(web.whatsapp.com) in your network</p></li>

<li><p><strong><a href="https://ooni.torproject.org/nettest/facebook-messenger/">Facebook Messenger test</a>:</strong> Designed to
examine the reachability of Facebook Messenger in your network</p></li>

<li><p><strong><a href="https://ooni.torproject.org/nettest/telegram/">Telegram test</a>:</strong> Designed
to examine the reachability of Telegram messenger and Telegram&rsquo;s web
version in your network</p></li>
</ul>

<p>The main advantages of collecting measurements through Raspberry Pis include the following:</p>

<ul>
<li><p>Stable and continuous daily measurements across extended periods of time</p></li>

<li><p>More types of data collection</p></li>

<li><p>More accurate measurements</p></li>
</ul>

<h2 id="requirements:7565a061641bd1e599d91e306fc304d1">Requirements</h2>

<p>The following include a list of requirements to get started:</p>

<ul>
<li><p><strong>Raspberry Pi:</strong> The Lepidopter Raspberry Pi image is compatible with all
types of Raspberry Pis (tested):</p>

<ul>
<li>Raspberry Pi 1 Model B</li>
<li>Raspberry Pi 1 Model B+</li>
<li>Raspberry Pi 2 Model B</li>
<li>Raspberry Pi 3 Model B</li>
</ul></li>

<li><p><strong>SD Card:</strong> We recommend a 4GB (minimum size) class 4 or higher SD card.</p></li>

<li><p><strong>Internet access:</strong> A standard Ethernet cable (such as a cat 5) attached to a
network router or switch that could provide internet connectivity. Typically the
&ldquo;device&rdquo; that enables you to access the internet!</p></li>

<li><p><strong>Power supply:</strong> Use a 5V micro USB power supply to power your Raspberry Pi.
Be careful that whatever power supply you use outputs at least 5V; insufficient
power will cause your Pi to behave in strange ways.</p></li>
</ul>

<p>If your laptop does not have an SD card slot, please ensure that you have an SD card reader.</p>

<h1 id="downloading-and-verifying-the-lepidopter-raspberry-pi-image:7565a061641bd1e599d91e306fc304d1">Downloading and verifying the Lepidopter Raspberry Pi image</h1>

<h2 id="download-the-lepidopter-image:7565a061641bd1e599d91e306fc304d1">Download the Lepidopter image</h2>

<ul>
<li><a href="https://get.ooni.torproject.org/lepidopter/lepidopter-v1.0.0-armel.img.zip">Lepidopter image download</a>,
<a href="https://get.ooni.torproject.org/lepidopter/lepidopter-v1.0.0-armel.img.zip.asc">(lepidopter image signature download)</a></li>
</ul>

<p>Consider downloading the <a href="https://get.ooni.torproject.org/lepidopter/lepidopter-v1.0.0-armel.img.xz">xz compressed image</a>
for a significantly reduced file size compared to the zip archive. The
signature to the xz compressed image can be found <a href="https://get.ooni.torproject.org/lepidopter/lepidopter-v1.0.0-armel.img.xz.asc">here</a>.
Note that this will require an <a href="http://tukaani.org/xz/">extra program</a> to be
installed depending on your OS.</p>

<p><strong>The default username and password of the image is</strong>: <code>lepidopter</code></p>

<h2 id="verify-lepidopter-raspberry-pi-image:7565a061641bd1e599d91e306fc304d1">Verify Lepidopter Raspberry Pi image</h2>

<h3 id="import-the-lepidopter-signing-key:7565a061641bd1e599d91e306fc304d1">Import the Lepidopter signing key</h3>

<p>From the OONI web server:</p>

<pre><code>gpg --fetch-keys https://get.ooni.torproject.org/lepidopter/lepidopter-signing-key.asc
</code></pre>

<p>From a keyserver:</p>

<pre><code>gpg --keyserver pool.sks-keyservers.net --recv-keys 625511968E240F24F6CFD0B6BA56AC5A53E9C7A4
</code></pre>

<p>Lepidopter team&rsquo;s fingerprint (image signing key) is published here:</p>

<pre><code>pub   4096R/0xBA56AC5A53E9C7A4 2016-05-22
      Key fingerprint = 6255 1196 8E24 0F24 F6CF  D0B6 BA56 AC5A 53E9 C7A4
uid   Lepidopter Team (signing key)
</code></pre>

<h3 id="set-the-trust-level-of-the-lepidopter-signing-key-optional:7565a061641bd1e599d91e306fc304d1">Set the trust level of the Lepidopter signing key (optional)</h3>

<p>Once you have obtained the lepidopter signing key, you should verify the
fingerprint of this key very carefully by obtaining copies of the fingerprint
from trustworthy independent sources and comparing them to the downloaded key’s
fingerprint to ensure they match. You could hen set the key&rsquo;s trust level to
“ultimate” (if you are satisfied with the verification process), so that you
are not getting any warnings about untrusted signatures:</p>

<pre><code>gpg --edit-key 0xBA56AC5A53E9C7A4
</code></pre>

<pre><code>pub  4096R/0xBA56AC5A53E9C7A4  created: 2016-05-22  expires: never       usage: SC
                               trust: unknown      validity: unknown

gpg&gt; fpr
pub   4096R/0xBA56AC5A53E9C7A4 2016-05-22 Lepidopter Team (signing key)
 Primary key fingerprint: 6255 1196 8E24 0F24 F6CF  D0B6 BA56 AC5A 53E9 C7A4

gpg&gt; trust
pub  4096R/0xBA56AC5A53E9C7A4  created: 2016-05-22  expires: never       usage: SC
                               trust: unknown      validity: unknown
sub  4096R/0x566AA65E9738B6C8  created: 2016-05-22  expires: never       usage: E
[unknown] (1). Lepidopter Team (signing key)

Please decide how far you trust this user to correctly verify other users' keys
(by looking at passports, checking fingerprints from different sources, etc.)

  1 = I don't know or won't say
  2 = I do NOT trust
  3 = I trust marginally
  4 = I trust fully
  5 = I trust ultimately
  m = back to the main menu

Your decision? 5
Do you really want to set this key to ultimate trust? (y/N) y

pub  4096R/0xBA56AC5A53E9C7A4  created: 2016-05-22  expires: never       usage: SC
                               trust: ultimate      validity: ultimate
sub  4096R/0x566AA65E9738B6C8  created: 2016-05-22  expires: never       usage: E
[ultimate] (1). Lepidopter Team (signing key)

gpg&gt; quit
</code></pre>

<h3 id="get-the-lepidopter-image-signature:7565a061641bd1e599d91e306fc304d1">Get the Lepidopter image signature</h3>

<p>Download the <a href="https://get.ooni.torproject.org/lepidopter/lepidopter-v1.0.0-armel.img.zip.asc">lepidopter image signature</a>.</p>

<h3 id="verify-the-lepidopter-image:7565a061641bd1e599d91e306fc304d1">Verify the Lepidopter image</h3>

<p>In order to verify the lepidopter image both the image archive (<code>.zip</code> or
<code>.asc</code>) and the signature file (<code>.asc</code>) should be within the same directory.</p>

<p>Verify that the compressed image <code>lepidopter-v1.0.0-armel.img.zip</code> matches its
signature <code>lepidopter-v1.0.0-armel.img.zip.asc</code> by running:</p>

<pre><code>gpg -v --verify lepidopter-v1.0.0-armel.img.zip.asc
</code></pre>

<p>You should look for the message <code>Good signature from &quot;Lepidopter Team (signing
key)&quot;</code>:</p>

<pre><code>gpg: assuming signed data in `lepidopter-v1.0.0-armel.img.zip'
gpg: Signature made Fri 05 May 2017
gpg:                using RSA key 0xBA56AC5A53E9C7A4
gpg: using PGP trust model
gpg: Good signature from &quot;Lepidopter Team (signing key)&quot;
gpg: binary signature, digest algorithm SHA512
</code></pre>

<p>If you want to learn more about digital signatures and key verification read
the <a href="https://www.qubes-os.org/doc/verifying-signatures/">documentation</a> from Qubes OS.</p>

<h1 id="setting-up-your-raspberry-pi-with-lepidopter:7565a061641bd1e599d91e306fc304d1">Setting up your Raspberry Pi with Lepidopter</h1>

<p>Depending on whether you are a Windows, Linux or Mac OS X user, please refer to
the relevant section of the guide below on how to set up your Raspberry Pi with
Lepidopter.</p>

<h2 id="linux-users:7565a061641bd1e599d91e306fc304d1">Linux users</h2>

<p>If you are using Ubuntu and hesitate to use the terminal, you can use <strong>Disk
Image Writer</strong> (graphical interface) to copy the Lepidopter image to an SD card.
Alternatively, you can do this through your terminal.</p>

<p>Below we provide steps on how to copy the Lepidopter image to an SD card via
Disk Image Writer or a terminal.</p>

<h3 id="disk-image-writer:7565a061641bd1e599d91e306fc304d1">Disk Image Writer</h3>

<p><strong>Step 1.</strong> Download the <strong><a href="https://get.ooni.torproject.org/lepidopter/lepidopter-v1.0.0-armel.img.zip">Lepidopter
image</a></strong>.</p>

<p><strong>Step 2.</strong> Right-click on the downloaded Lepidopter image and select <strong>[Extract
here]</strong> to extract the image.</p>

<p><img src="/lepidopter/lepidopter-lin-001.png" alt="Lepidopter-ubuntu" /></p>

<p><img src="/lepidopter/lepidopter-lin-002.png" alt="Lepidopter-ubuntu" /></p>

<p><strong>Step 3.</strong> Install <strong>Disk Image Writer</strong> from the Ubuntu Software Center.</p>

<p><strong>Step 4.</strong> Insert your SD card into your SD card reader, and subsequently connect
your SD card reader to your laptop/desktop.</p>

<p><strong>Step 5.</strong> Right-click on the extracted Lepidopter image and open it with Disk Image Writer.</p>

<p><img src="/lepidopter/lepidopter-lin-003.png" alt="Lepidopter-ubuntu" /></p>

<p><strong>Step 6.</strong> Select your SD card reader within the drop-down menu.</p>

<p><img src="/lepidopter/lepidopter-lin-005.png" alt="Lepidopter-ubuntu" /></p>

<p><strong>Important:</strong> Ensure you&rsquo;re selecting your SD card reader, as (accidentally)
selecting your hard drive could result in its corruption.</p>

<p><strong>Step 7.</strong> Click <strong>[Start Restoring&hellip;]</strong>. This will copy the Lepidopter image to your SD card.</p>

<p><img src="/lepidopter/lepidopter-lin-006.png" alt="Lepidopter-ubuntu" /></p>

<p><strong>Step 8.</strong> Click <strong>[Restore]</strong>.</p>

<p><img src="/lepidopter/lepidopter-lin-007.png" alt="Lepidopter-ubuntu" /></p>

<p><strong>Step 9.</strong> Type in your system password to authenticate this.</p>

<p><img src="/lepidopter/lepidopter-lin-008.png" alt="Lepidopter-ubuntu" /></p>

<p>Wait for the Lepidopter image to get copied to your SD card&hellip;</p>

<p><img src="/lepidopter/lepidopter-lin-010.png" alt="Lepidopter-ubuntu" /></p>

<p><strong>Step 10.</strong> Eject when it&rsquo;s done.</p>

<p><img src="/lepidopter/lepidopter-lin-011.png" alt="Lepidopter-ubuntu" /></p>

<p>Now your SD card contains OONI&rsquo;s software!</p>

<p><strong>Step 11.</strong> Insert your SD card into the <strong>[MICRO SD CARD]</strong> slot of your Raspberry Pi.</p>

<p><strong>Step 12.</strong> Connect your Raspberry Pi to power and to the internet (with an Ethernet cable).</p>

<p>That&rsquo;s all! From now on, your Raspberry Pi will automatically <strong>run ooniprobe
every day at 6am UTC</strong>. The measurements will be sent directly to OONI&rsquo;s server,
where they will be processed and published on <strong><a href="https://explorer.ooni.torproject.org/world/">OONI
Explorer</a></strong> (generally) within 24
hours.</p>

<h3 id="terminal:7565a061641bd1e599d91e306fc304d1">Terminal</h3>

<p>Please note that the use of the &ldquo;dd&rdquo; tool can overwrite any partition of your
machine. If you specify the wrong device in the instructions below you could
delete your primary Linux partition. Please be careful.</p>

<p><strong>Step 1.</strong> Download the <a href="https://get.ooni.torproject.org/lepidopter/lepidopter-v1.0.0-armel.img.zip">Lepidopter
image</a>.</p>

<p><strong>Step 2.</strong> Extract the image:</p>

<p><code>unzip lepidopter-v1.0.0-armel.img.zip</code></p>

<p>If you have downloaded the <a href="https://get.ooni.torproject.org/lepidopter/lepidopter-v1.0.0-armel.img.xz">xz compressed image</a>:</p>

<p><code>xz --decompress --verbose --no-sparse lepidopter-v1.0.0-armel.img.xz</code></p>

<p><strong>Step 3.</strong> Run <code>df -h</code> to see which devices are currently mounted.</p>

<p><strong>Step 4.</strong> If your computer has a slot for SD cards, insert the card. If not,
insert the card into an SD card reader, then connect the reader to your
computer.</p>

<p><strong>Step 5.</strong> Run <code>df -h</code> again.</p>

<p>The device that wasn&rsquo;t there last time is your SD card. The left column gives
the device name of your SD card. It will be listed as something like
&ldquo;/dev/mmcblk0p1&rdquo; or &ldquo;/dev/sdd1&rdquo;. The last part (&ldquo;p1&rdquo; or &ldquo;1&rdquo; respectively) is the
partition number, but you want to write to the whole SD card, not just one
partition, so you need to remove that part from the name (getting for example
&ldquo;/dev/mmcblk0&rdquo; or &ldquo;/dev/sdd&rdquo;) as the device for the whole SD card.</p>

<p><strong>Note:</strong> The SD card can show up more than once in the output of df: in fact it
will if you have previously written a Raspberry Pi image to this SD card,
because the Raspberry Pi SD images have more than one partition.</p>

<p><strong>Step 6.</strong> Now that you&rsquo;ve noted what the device name is, you need to unmount
it so that files can&rsquo;t be read or written to the SD card while you are copying
over the SD image. So run the command below, replacing &ldquo;/dev/sdd1&rdquo; with whatever
your SD card&rsquo;s device name is (including the partition number):</p>

<pre><code>umount /dev/sdd1     
</code></pre>

<p>If your SD card shows up more than once in the output of df due to having
multiple partitions on the SD card, you should unmount all of these partitions.</p>

<p><strong>Step 7.</strong> In the terminal copy the image to the card with this command,
making sure you replace the input file if= argument with the path to your .img
file, and the &ldquo;/dev/sdd&rdquo; in the output file of= argument with the right device
name (this is very <strong>important:</strong> you will lose all data on the hard drive on
your computer if you get the wrong device name). Make sure the device name is
the name of the whole SD card as described above, not just a partition of it
(for example, sdd, not sdds1 or sddp1, or mmcblk0 not mmcblk0p1).</p>

<pre><code>dd bs=4M if=~/lepidopter-v1.0.0-armel.img of=/dev/sdd
</code></pre>

<p>Please note that block size set to 4M will work most of the time. If not, please try
1M, although 1M will take considerably longer.</p>

<p>Note that if you are not logged in as root you will need to prefix this with sudo.</p>

<p>The dd command does not give any information of its progress and so may
appear to have frozen. It could take more than five minutes to finish copying
to the card. If your card reader has an LED it may blink during the write
process. To see the progress of the copy operation you can run <code>pkill -USR1
-n -x</code> dd in another terminal (prefixed with sudo if you are not logged in as
root). The progress will be displayed (perhaps not immediately, due to
buffering) in the original window, not the window with the pkill command.</p>

<p><strong>Step 8.</strong> As root run the command sync or if a normal user run <code>sudo sync</code>
(this will ensure the write cache is flushed and that it is safe to unmount
your SD card).</p>

<p><strong>Step 9.</strong> Remove the SD card from your card reader, insert it in the Raspberry
Pi, and have fun!</p>

<h2 id="mac-os-x-users:7565a061641bd1e599d91e306fc304d1">Mac OS X users</h2>

<p>You can copy the Lepidopter image to your SD card through the following steps:</p>

<p><strong>Step 1.</strong> Download the <strong><a href="https://get.ooni.torproject.org/lepidopter/lepidopter-v1.0.0-armel.img.zip">Lepidopter
image</a></strong>.</p>

<p><strong>Step 2.</strong> Double-click on the downloaded Lepidopter image to extract it.</p>

<p><strong>Step 3.</strong> Download <strong><a href="http://www.tweaking4all.com/hardware/raspberry-pi/macosx-apple-pi-baker/">ApplePi-Baker</a></strong>.</p>

<p><img src="/lepidopter/ApplePi-Baker.png" alt="ApplePi-Baker window" /></p>

<p>ApplePi-Baker is a free utility that allows you to copy an IMG file to an SD
card with only a few simple clicks.</p>

<p><strong>Step 4.</strong> Insert your SD card into your SD card reader, and subsequently connect
your SD card reader to your laptop/desktop.</p>

<p><strong>Step 5.</strong> Start ApplePi-Baker.</p>

<p><strong>Step 6.</strong> Select the Lepidopter IMG file in the Restore Backup section.</p>

<p><strong>Step 7.</strong> Select your SD card reader (in the Pi-Crust section) as a location to
copy the Lepidopter image to.</p>

<p><strong>Important:</strong> Ensure you&rsquo;re selecting your SD card reader, as (accidentally)
selecting your hard drive could result in its corruption.</p>

<p><strong>Step 8.</strong> Click <strong>[Restore Backup]</strong>.</p>

<p>Wait for the Lepidopter image to get copied to your SD card&hellip;</p>

<p><strong>Step 9.</strong> Type in your system password to authenticate this.</p>

<p><strong>Step 10.</strong> Eject when it&rsquo;s done.</p>

<p><strong>Step 11.</strong> Insert your SD card into the <strong>[MICRO SD CARD]</strong> slot of your Raspberry Pi.</p>

<p><strong>Step 12.</strong> Connect your Raspberry Pi to power and to the internet (with an Ethernet cable).</p>

<p>That&rsquo;s all! From now on, your Raspberry Pi will automatically <strong>run ooniprobe
every day at 6am UTC</strong>. The measurements will be sent directly to OONI&rsquo;s server,
where they will be processed and published on <strong><a href="https://explorer.ooni.torproject.org/world/">OONI
Explorer</a></strong> (generally) within 24
hours.</p>

<h3 id="optimization:7565a061641bd1e599d91e306fc304d1">Optimization</h3>

<p>In OS X each disk may have two path references in /dev:</p>

<ul>
<li><p>/dev/disk# is a buffered device, which means any data being sent undergoes
extra processing.</p></li>

<li><p>/dev/rdisk# is a raw path, which is much faster, and perfectly OK when using
the dd program.</p></li>
</ul>

<p>On a Class 4 SD card the difference was around 20 times faster using the rdisk
path.</p>

<h2 id="windows-users:7565a061641bd1e599d91e306fc304d1">Windows users</h2>

<p>You can copy the Lepidopter image to your SD card through the following steps:</p>

<p><strong>Step 1.</strong> Download the <strong><a href="https://get.ooni.torproject.org/lepidopter/lepidopter-v1.0.0-armel.img.zip">Lepidopter
image</a></strong>.</p>

<p><strong>Step 2.</strong> Extract the image file from the downloaded .xz file, so you now
have
&ldquo;lepidopter-v1.0.0-armel.img&rdquo;.</p>

<p><strong>Step 3.</strong> Download
<a href="http://sourceforge.net/projects/win32diskimager/">Win32DiskImager</a> and
extract the file.</p>

<p><img src="/lepidopter/Win32DiskImager.png" alt="Win32DiskImager window" /></p>

<p><strong>Step 4.</strong> Insert the SD card into your SD card reader and check what drive
letter it was assigned. You can easily see the drive letter (for example G:)
by looking in the left column of Windows Explorer.</p>

<p><strong>Step 5.</strong> Run Win32DiskImager.</p>

<p>You might need to run Win32DiskImager as Administrator. In this case, right-
click on the file, and select &lsquo;Run as Administrator&rsquo;.</p>

<p><strong>Step 6.</strong> Select the Lepidopter image file that you extracted above.</p>

<p><strong>Step 7.</strong> Select the drive letter of the SD card in the device box.</p>

<p><strong>Important:</strong> Ensure you&rsquo;re selecting your SD card reader, as (accidentally)
selecting your hard drive could result in its corruption.</p>

<p><strong>Step 8.</strong> Click <strong>[Write]</strong>.</p>

<p>Wait for the Lepidopter image to get copied to your SD card&hellip;</p>

<p><strong>Step 9.</strong> Exit the imager and eject the SD card.</p>

<p><strong>Step 10.</strong> Insert your SD card into the <strong>[MICRO SD CARD]</strong> slot of your
Raspberry Pi.</p>

<p><strong>Step 11.</strong> Connect your Raspberry Pi to power and to the internet (with an
Ethernet cable).</p>

<p>That&rsquo;s all! From now on, your Raspberry Pi will automatically <strong>run ooniprobe
every day at 6am UTC</strong>. The measurements will be sent directly to OONI&rsquo;s
server,
where they will be processed and published on <strong><a href="https://explorer.ooni.torproject.org/world/">OONI
Explorer</a></strong> (generally) within 24
hours.</p>

<p><strong>Note:</strong> In Windows, the SD card will appear to only have a fairly small size
once
written - about 55 to 75 MB. This is because most of the card has a partition
that is formatted for the Linux operating system that the Raspberry Pi uses
which is not visible in Windows. If you don&rsquo;t see a small directory with files
such as kernel.img then the copy may not have worked correctly.</p>

<h3 id="using-flashnul-if-win32diskimager-isn-t-successful:7565a061641bd1e599d91e306fc304d1">Using flashnul (if Win32DiskImager isn&rsquo;t successful)</h3>

<p>You might not be able to choose the device in Win32DiskImager on some notebooks,
so this is a different way to achieve the same thing on a Windows machine.</p>

<p><strong>Step 1.</strong> Download the <strong><a href="https://get.ooni.torproject.org/lepidopter/lepidopter-v1.0.0-armel.img.zip">Lepidopter
image</a></strong>.</p>

<p><strong>Step 2.</strong> Extract the image file from the downloaded .xz file, so you now have
&ldquo;lepidopter-v1.0.0-armel.img&rdquo;.</p>

<p><strong>Step 3.</strong> Download <a href="http://shounen.ru/soft/flashnul/index.html">flashnul</a>.</p>

<p>The English translated version can be found <a href="http://translate.google.com/translate?hl=en&amp;sl=ru&amp;tl=en&amp;u=http%3A%2F%2Fshounen.ru%2Fsoft%2Fflashnul%2Findex.html">here</a>
with a link to instructions (also translated).</p>

<p><strong>Step 4.</strong> Insert the SD card into your SD card reader and check what drive
letter it was assigned. You can easily see the drive letter (for example G:)
by looking in the left column of Windows Explorer.</p>

<p><strong>Step 5.</strong> Extract the application from the archive.</p>

<p><strong>Step 6.</strong> Click Start button &gt; All Programs &gt; Accessories &gt; Command Prompt,
right click on it and Run as Administrator.</p>

<p><strong>Step 7.</strong> Run flashnul with argument &ldquo;-p&rdquo;:</p>

<ul>
<li><code>C:\flashnul\flashnul.exe -p</code></li>
</ul>

<p><strong>Step 8.</strong> Flashnul will tell you something like this (it should be different, as it
   depends on the drives on your machine):</p>

<ul>
<li>Available physical drives:</li>
<li>0       size = 250059350016 (232 Gb)</li>
<li>1       size = 1990197248 (1898 Mb)</li>
<li>Available logical disks:</li>
<li>C:\</li>
<li>D:\</li>
<li>E:\</li>
<li>F:\</li>
<li>Press ENTER to exit.</li>
</ul>

<p><strong>Step 9.</strong> Use the Load option of flashnul to put the image file on the SD Card.
Make sure that you use the correct drive letter for the SD Card as that drive
will be overwritten!</p>

<ul>
<li><code>C:\flashnul\flashnul.exe E: -L C:\temp\lepidopter-v1.0.0-armel.img</code></li>
</ul>

<p><strong>Step 10.</strong> Where <code>C:\flashnul\flashnul.exe</code> is the location of the flashnul
program; E: is the drive you want to overwrite, and
<code>C:\temp\lepidopter-v1.0.0-armel.img</code> is the location of the .img file.</p>

<p><strong>Step 11.</strong> Flashnul will give you a device summary and a caution message. Check
the information to make sure you have selected the correct device, then type
yes and press enter.</p>

<p>If you get an access denied error, make sure to close all explorer windows or
folders open for the device, then try re-plugging the SD card.</p>

<h1 id="lepidopter-services:7565a061641bd1e599d91e306fc304d1">Lepidopter services</h1>

<p>Lepidopter uses a mDNS (multicast DNS Service Discovery) (Avahi) to publish the
SSH and ooniprobe web interface services on a local network with no extra
configuration or the need to find out the IP address of the Lepidopter host.</p>

<h2 id="access-ooniprobe-s-web-interface:7565a061641bd1e599d91e306fc304d1">Access ooniprobe&rsquo;s web interface</h2>

<p>If you have the required dependencies you should be able to access
ooniprobe web interface by entering the following URL to your web browser:
<a href="http://lepidopter.local">http://lepidopter.local</a></p>

<p>If you can&rsquo;t access ooniprobe&rsquo;s <a href="http://lepidopter.local">web interface URL</a> please follow the installation <a href="#service-discovery-install-instructions">instructions</a> related to your operating system.</p>

<h2 id="access-lepidopter-ssh-service:7565a061641bd1e599d91e306fc304d1">Access lepidopter SSH service</h2>

<p>You should be able to access Lepidopter&rsquo;s SSH service under the following
hostname: <code>lepidopter.local</code></p>

<h2 id="service-discovery-install-instructions:7565a061641bd1e599d91e306fc304d1">Service discovery install instructions</h2>

<h3 id="linux:7565a061641bd1e599d91e306fc304d1">Linux</h3>

<p>Most Linux distributions (Debian, Fedora, Ubuntu, Archlinux) use the Avahi
daemon by default. In case your system doesn&rsquo;t come with the Avahi daemon
pre-installed you should be able to install it via the package manager of
your distribution, the name of the package is usually something similar to
<code>avahi-daemon</code>. You should be able to check if the service is running by using
a command similar to:</p>

<p><code>systemctl status avahi-daemon</code></p>

<p>You should be able to see an <code>active (running)</code> service status.</p>

<p>If the avahi service is not running try to start it with: <code>systemctl start
avahi-daemon</code> or <code>service avahi-daemon start</code> depending on your distribution.</p>

<h3 id="mac-osx-ios:7565a061641bd1e599d91e306fc304d1">Mac OSX/iOS</h3>

<p>Mac OS X and iOS operating systems have builtin support for mDNS/DNS-SD with
the Bonjour software.</p>

<h3 id="windows:7565a061641bd1e599d91e306fc304d1">Windows</h3>

<p>Recent Windows releases (Windows 10 and Windows 10 mobile) come with built in
support for mDNS/DNS-SD services. However not all versions of Windows support
these services and some third-party applications need to be installed
(if not already installed) that come bundled with the Bonjour software; a
service that supports automatic discovery of hosts in the local network.</p>

<p>If you have any of the following applications installed and can access
ooniprobe&rsquo;s web interface you don&rsquo;t need to do anything, otherwise you
will need to <a href="https://support.apple.com/kb/dl999">download</a> and install
Bonjour Print Services for Windows.</p>

<p>Applications that are bundled with the Bonjour software in Windows:</p>

<ul>
<li>Bonjour Print Services for Windows</li>
<li>Skype</li>
<li>iTunes</li>
<li>Adobe&rsquo;s Photoshop CS3</li>
</ul>

<p><strong>Note</strong>: Before installing any application you should first try to access
ooniprobe&rsquo;s <a href="http://lepidopter.local">web interface URL</a> from your web
browser.</p>

<h2 id="troubleshooting-service-discovery:7565a061641bd1e599d91e306fc304d1">Troubleshooting service discovery</h2>

<p>The <code>.local</code> domain extension is an officially reversed special use domain name
and should not be resolvable by IPSs or other global DNS.
By default avahi service is being disabled upon detection of a unicast DNS
server running on the network that serves the top level domain <code>.local</code>.</p>

<p>In some cases network routers use the <code>.lan</code> or <code>.home</code> domain for all devices
connected in LAN.</p>

<p>You may be able to access ooniprobe&rsquo;s web interface under the following URLs:</p>

<ul>
<li><a href="http://lepidopter.local">http://lepidopter.local</a></li>
<li><a href="http://lepidopter.lan">http://lepidopter.lan</a></li>
<li><a href="http://lepidopter.home">http://lepidopter.home</a></li>
<li><a href="http://lepidopter">http://lepidopter</a></li>
</ul>

<p>If you are unable to access ooniprobe&rsquo;s web interface in any of the URLs above
you should try to locate the Lepidopter&rsquo;s IP address in your network.</p>

<h3 id="find-lepidopter-s-ip-address:7565a061641bd1e599d91e306fc304d1">Find Lepidopter&rsquo;s IP address</h3>

<p>There are a number of applications and network tools that can help in finding
out the IP address of Lepidopter in your network. You can use Adafruit&rsquo;s <a href="https://github.com/adafruit/Adafruit-Pi-Finder/releases/latest">Pi
finder utility</a>
which can be installed in Linux, Mac OSX and Windows. Upon running the Pi
finder utility you should be seeing the message <code>Found!</code> and view the detected
IP address of Lepidopter located in the <code>IP Address</code> field.</p>

<p>You can now use the IP address (found in the IP address field) to access
ooniprobe&rsquo;s web interface in your web browser.</p>

<h1 id="community-information-and-contributing:7565a061641bd1e599d91e306fc304d1">Community Information and Contributing</h1>

<h2 id="report-bugs:7565a061641bd1e599d91e306fc304d1">Report bugs</h2>

<p>Lepidopter bugs, feature requests and usability issues should be filed
<a href="https://github.com/TheTorProject/lepidopter/issues">here</a>.</p>

<h2 id="participate:7565a061641bd1e599d91e306fc304d1">Participate</h2>

<p>For people already running a Lepidopter probe and would like to follow up on
operators specific discussion you are welcome to subscribe to the low volume
<a href="https://lists.torproject.org/cgi-bin/mailman/listinfo/ooni-operators">ooni-operators</a> mailing
list.</p>

<h2 id="contribute:7565a061641bd1e599d91e306fc304d1">Contribute</h2>

<p>Lepidopter distribution build scripts, and code is hosted <a href="https://github.com/TheTorProject/lepidopter">here</a>. You are welcome to contribute
by sending up patches or pull requests. Read on how you can
<a href="/get-involved/">get involved</a> and reach out to us.</p>

<h1 id="sources:7565a061641bd1e599d91e306fc304d1">Sources</h1>

<ul>
<li><a href="http://elinux.org/RPi_Easy_SD_Card_Setup">RPi Easy SD Card Setup</a></li>
<li><a href="https://www.raspberrypi.org/documentation/">Raspberry Pi Documentation</a></li>
<li><a href="https://www.qubes-os.org/doc/verifying-signatures/">On Digital Signatures and Key Verification</a></li>
</ul>

  </main>
</div>

<footer>
  <div class="container row">
    (c) 2016 - The Open Observatory of Network Interference
    <a href="/data-policy/">
        OONI Data Policy
    </a>
  </div>
</footer>

</body>
</html>

